<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 8 ]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <noscript><meta http-equiv="refresh" content="0; RL=/nojavascript"/></noscript>

  <!--[if lt IE 7 ]> 
  <script type="text/javascript">
        window.location = '/ie6';
  </script>

  <![endif]-->
  <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
       Remove this if you use the .htaccess -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>A.P.E.S. Dashboard</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile viewport optimized: j.mp/bplateviewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Place favicon.ico & apple-touch-icon.png in the root of your domain and delete these references
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
 -->

  <!-- CSS: implied media="all" -->
  <%= css :application %>

  <!-- Uncomment if you are specifically targeting less enabled mobile browsers
  <link rel="stylesheet" media="handheld" href="css/handheld.css?v=2">  -->

  <!-- All JavaScript at the bottom, except for Modernizr which enables HTML5 elements & feature detects -->
  <script src="js/libs/modernizr-2.0.6.js"></script>
  <script src="jst.tpl"></script>

  <script src="js/mootools-1.2.5-core-nc.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>
<div class="container">
  <div id="sidebar">
    <h1>A.P.E.S. Dashboard <span class="beta">beta</span></h1>
    <div class="form-box first-box">
      <form action="#" class="select-form">
        <fieldset>
          <div class="slide-block first">
            <div class="holder">
              <div class="frame">
                <div id="categories_filter_edit" class="content">
                  <div class="title">
                    <a href="#" class="open-close"><span>Done</span><em>Edit</em></a>
                    <a href="#" class="back-button hide">Back</a>
                    <strong>SPECIES: </strong>
                    <span class="selected"><a href="#"><span class="count">0</span> selected</a></span>
                    <a href="#" class="clear_all">select all</a>
                  </div>
                  <div class="block" style="display: none; ">
                    <div class="block-holder">
                      <strong class="heading">Select categories</strong>
                      <div id="categories_selector" class="box"></div>
                      <div id="apes_selector" class="hide box"></div>
                      <div id="species_selector" class="hide box"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="slide-block last">
            <div class="holder">
              <div class="frame">
                <div id="countries_filter_edit" class="content">
                  <div class="title">
                    <a id="finish-countries-edit" href="#" class="open-close"><span>Done</span><em>Edit</em></a>
                    <strong>COUNTRIES: </strong>
                    <span class="selected"><a href="#"><span class="count">0</span> selected</a></span>
                  </div>
                  <div class="block" style="display: none; ">
                    <div class="block-holder">
                      <strong class="heading">Select countries</strong>
                      <div id="countries_selector" class="box"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </fieldset>
      </form>
    </div>
    <div class="form-box">
      <form action="#" class="range-form">
        <fieldset>
          <div class="slide-block">
            <div class="holder">
              <div class="frame">
                <div class="content">
                  <label for="amount">Response</label>
                  <a class='btn active'>Show</a>
                  <div class="range response">
                    <input class="text min-value" type="text" value="0">
                    <div class="ui-slider"></div>
                    <input class="text max-value" type="text" value="1">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="slide-block style2">
            <div class="holder">
              <div class="frame">
                <div class="content">
                  <label for="amount2">Biodiversity</label>
                  <a class='btn'>Show</a>
                  <div class="range biodiversity">
                    <input class="text min-value" type="text" value="0">
                    <div class="ui-slider"></div>
                    <input class="text max-value" type="text" value="1">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="slide-block style3">
            <div class="holder">
              <div class="frame">
                <div class="content">
                  <label for="amount3">Site Area (km2)</label>
                  <div class="range size">
                    <input class="text min-value" type="text" value="0">
                    <div class="ui-slider" id="area_slider"></div>
                    <input class="text max-value" type="text" value="100">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </fieldset>
      </form>
    </div>
    <div class="filter-buttons">
      <strong>Filter by:</strong>
      <ul>
        <li><a href="#" class="filter_by active">Protected Areas</a></li>
        <li><a href="#" class="filter_by active">Action Plan Site</a></li>
        <li><a href="#" class="filter_by active">Landscapes</a></li>
      </ul>
    </div>
    <div class="help-box">
      <span>Help</span>
      <a href="#" class="help">?</a>
      <div id="help-box" class="hide">
        <%= erb :_help_box_text %>
      </div>
      <ul id='methodology-links'>
        <li><a href="#">Methodology</a></li>
        <li><a href="#">Tutorial</a></li>
      </ul>
    </div>
    <div class="share-box">
      <!--
      <a href="#" class="share">share this report</a>
      -->
      <div id="result-strip" class="heading"></div>
    </div>
  </div>
  <div id="content">
    <div class="view-panel">
      <span>View:</span>
      <ul>
        <li class="graph active"><a href="#">GRAPH</a><span></span></li>
        <li class="map"><a href="#">MAP</a><span></span></li>
        <li class="table"><a href="#">TABLE</a><span></span></li>
      </ul>
    </div>
    <div id="graph"></div>
    <div id="main_map" class="map_container hide">
      <div class="layers">
        <a href="#view" class="view"><span>VIEWING <b class="layer_number">3 LAYERS</b></span></a>
        <div class="show_layer">
          <span class="top"></span>
          <ul class="dropdown">
            <a class="expand" href="#expand">expand</a>
          </ul>
        </div>
      </div>
      <div class="zoom_control">
        <a href="#zoom_in" class="zoom_in">zoom_in</a>
        <a href="#zoom_out" class="zoom_out">zoom_out</a>
      </div>
      <div id="map"></div>
    </div>
    <div id="table" class="hide">
      <div id='table_header'>
          <h2>SITES:</h2>
          <a href="#download" id="download_table_button" class="btn"><span>Download Detailed Results Table</span></a>
          <a href="#download" id="download_button" class="btn"><span>Download Summary Results table</span></a>
      </div>
      <table id="results-table">
        <thead>
          <tr>
            <th>IAS ID</th>
            <th>Name</th>
            <th>Category</th>
            <th>Area (KM<sup>2</sup>)</th>
            <th>Pressure</th>
            <th>Habitat</th>
            <th>Response</th>
            <th>Biodiversity</th>
            <th>Analysis Taxa Present</th>
            <th>Driving Taxon</th>
            <th>Taxon-Site Overlap</th>
            <th>Uncertainty</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
  <div id="landing" class="hide">
    <h2>Welcome to the A.P.E.S. Dashboard <span class="beta">beta</span></h2>
    <%= erb :_landing_text%>

      <p class="instructions">Select a region to get started:</p>
      <button id="select_region_1" class="select_region">Africa</button>
      <button id="select_region_2" class="select_region">Asia</button>
  </div>

  <!-- JavaScript at the bottom for fast page loading -->

  <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if necessary -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
  <script>window.jQuery || document.write("<script src='js/libs/jquery-1.5.1.min.js'>\x3C/script>")</script>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false&libraries=geometry""></script>
  <script>window.JSON || document.write("<script src='js/libs/json2.js'>\x3C/script>")</script>

    <%= js :main_app %>

  <script>
    function number_format(n) {
        var s = n.toFixed(0);
        var chrs = [];
        var c = 0;
        for(var i = s.length - 1; i != -1; --i, ++c) {
            if(((c % 3) == 0) && c > 0) {
                chrs.push(',');
            }
            chrs.push(s.charAt(i));
        }
        return chrs.reverse().join('');
    }
  </script>


  <!-- end scripts-->
  <script>

    //Setup jQuery
    jQuery.support.cors = true;
    jQuery.noConflict();

    mooTools = $; // Store mooTools
    function init() {
      // use timeout trick to avoid jquery catch the exceptions thrown
      setTimeout(function() {
        App(function(app) {
          var carbon = new app.Carbon();
          carbon.run();
          //debug
          window.carbon = carbon;
          window._app= app;
        });
      }, 100);
    }
    // We want to use jQuery,not mootools
    $ = jQuery;
    jQuery(function($) {
      init();
    }(jQuery));
    jQuery(function(){//wait for the dom to be ready, before starting the landing dialog
      setTimeout(function(){
        jQuery("#landing").dialog({
          width: 600,
          minWidth: 650,
          modal: true,
          position: 'center',
          autoOpen: (window.location.hash.length == 0),
          closeText: ''
      });}, 1000);
      //initialize help box
      var viewPortWidth = 651;
      var viewPortHeight = 538;
      $("#help-box").dialog({
        dialogClass: 'help-box-dialog',
        position: [272,0],
        width: viewPortWidth,
        //maxWidth: viewPortWidth,
        height: viewPortHeight,
        //maxHeight: viewPortHeight,
        resizable: false,
        title: 'Help',
        autoOpen: false
      });
      });
  </script>


  <!--[if lt IE 7 ]>
    <script src="js/libs/dd_belatedpng.js"></script>
    <script>DD_belatedPNG.fix("img, .png_bg"); // Fix any <img> or .png_bg bg-images. Also, please read goo.gl/mZiyb </script>
  <![endif]-->


  <!-- mathiasbynens.be/notes/async-analytics-snippet Change UA-XXXXX-X to be your site's ID -->
  <!--<script>
    var _gaq=[["_setAccount","UA-6510422-1"],["_trackPageview"]];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
    g.src=("https:"==location.protocol?"//ssl":"//www")+".google-analytics.com/ga.js";
    s.parentNode.insertBefore(g,s)}(document,"script"));
   </script>-->
</div>
</body>
</html>
